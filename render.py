import streamlit as st
import re


bot_msg_container_html_template = """
<div style='background-color: #FFFFFF; padding: 10px; border-radius: 5px; margin-bottom: 10px; display: flex'>
    <div style="width: 20%; display: flex; justify-content: center">
        <img src="data:image/png;base64,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" style="max-height: 100px; max-width: 100px; border-radius: 50%;">
    </div>
    <div style="width: 80%;">
        $MSG
    </div>
</div>
"""

user_msg_container_html_template = """
<div style='pink: #FFFFFF; padding: 10px; border-radius: 5px; margin-bottom: 10px; display: flex'>
    <div style="width: 78%">
        $MSG
    </div>
    <div style="width: 20%; margin-left: auto; display: flex; justify-content: center;">
        <img src="data:image/jpeg;base64,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" style="max-width: 50px; max-height: 50px; float: right; border-radius: 50%;">
    </div>    
</div>
"""


def render_article_preview(docs, tickers):
    message = f"<h5>Here are relevant articles for {tickers} that may answer your question. &nbsp; &nbsp;</h5>"
    message += "<div>"
    for d in docs:
        elipse = " ".join(d[2].split(" ")[:140])
        message += f"<br><a href='{d[1]}'>{d[0]}</a></br>"
        message += f"<p>{elipse} ...</p>"
        message += "<br>"
    message += "</div>"
    return message


def render_earnings_summary(ticker, summary):
    transcript_title = summary["transcript_title"]
    message = f"<h5>Here is summary for {ticker} {transcript_title} </h5>"
    message += "<div>"
    body = re.sub(r"^-", r"*  ", summary["summary"])
    body = re.sub(r"\$", r"\\$", body)
    message += f"<p>{body}</p>"
    message += "</div>"
    return message


def render_stock_question(answer, articles):
    message = "<div>"
    message += f"{answer} &nbsp; <br>"
    message += "Sources: "
    for a in articles:
        message += f"<a href='{a[1]}'>{a[0]}</a><br>"
    message += "</div>"
    return message


def render_chat(**kwargs):
    """
    Handles is_user
    """
    if kwargs["is_user"]:
        st.write(
            user_msg_container_html_template.replace("$MSG", kwargs["message"]),
            unsafe_allow_html=True,
        )
    else:
        st.write(
            bot_msg_container_html_template.replace("$MSG", kwargs["message"]),
            unsafe_allow_html=True,
        )

    if "figs" in kwargs:
        for f in kwargs["figs"]:
            st.plotly_chart(f, use_container_width=True)
